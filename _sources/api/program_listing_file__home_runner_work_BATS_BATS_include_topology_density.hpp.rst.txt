
.. _program_listing_file__home_runner_work_BATS_BATS_include_topology_density.hpp:

Program Listing for File density.hpp
====================================

|exhale_lsh| :ref:`Return to documentation for file <file__home_runner_work_BATS_BATS_include_topology_density.hpp>` (``/home/runner/work/BATS/BATS/include/topology/density.hpp``)

.. |exhale_lsh| unicode:: U+021B0 .. UPWARDS ARROW WITH TIP LEFTWARDS

.. code-block:: cpp

   #pragma once
   /*
   utilities to compute density on point clouds
   */
   
   #include "data.hpp"
   #include "metric.hpp"
   #include "neighborhood.hpp"
   
   namespace bats {
   
   // get distance to kth nearest neighbor
   template <typename T, typename M>
   std::vector<T> kdist(
       const DataSet<T> &X,
       const M& dist,
       const size_t k
   ) {
       std::vector<T> dk(X.size());
   
       auto pdist = dist(X, X);
   
       std::vector<T> dj(X.size());
   
       for (size_t j = 0; j < X.size(); j++) {
           // copy column into vector
           for (size_t i = 0; i < X.size(); i++) {
               dj[i] = pdist(i,j);
           }
           // find kth largest element
           std::nth_element(dj.begin(), dj.begin() + k, dj.end());
           dk[j] = dj[k];
       }
   
       return dk;
   }
   
   } // namespace bats
